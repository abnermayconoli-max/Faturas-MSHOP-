<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Login - Faturas MSHOP</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body{margin:0;font-family:system-ui;background:#0b1220;color:#e5e7eb;min-height:100vh;display:grid;place-items:center}
    .card{width:100%;max-width:420px;background:#0f1a2e;border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:22px;box-shadow:0 10px 30px rgba(0,0,0,.35)}
    h1{margin:0 0 6px;font-size:22px}
    .muted{color:#94a3b8;font-size:13px;margin:0 0 12px}
    label{display:block;margin:12px 0 6px;font-size:13px;color:#cbd5e1}
    input{width:100%;padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,.12);background:#0b1426;color:#e5e7eb;outline:none}
    .btn{margin-top:14px;width:100%;padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,.14);background:#1f6feb;color:white;font-weight:700;cursor:pointer}
    .btn:hover{filter:brightness(1.05)}
    .alert{margin-top:10px;padding:10px 12px;border-radius:10px;font-size:13px;background:rgba(239,68,68,.12);border:1px solid rgba(239,68,68,.25)}
    .links{margin-top:14px;display:flex;justify-content:space-between}
    a{color:#93c5fd;text-decoration:none} a:hover{text-decoration:underline}

    /* seletor Admin/Login */
    .mode-box{display:flex;gap:10px;margin:10px 0 8px}
    .mode-btn{
      flex:1;border-radius:10px;border:1px solid rgba(255,255,255,.14);
      background:#0b1426;color:#e5e7eb;padding:10px 12px;font-weight:700;cursor:pointer
    }
    .mode-btn.active{background:#1f6feb;border-color:rgba(31,111,235,.55)}
    .mode-hint{margin-top:6px;font-size:12px;color:#94a3b8}
  </style>
</head>
<body>
  <div class="card">
    <h1>Faturas MSHOP</h1>
    <p class="muted">Escolha o tipo de acesso e depois informe suas credenciais.</p>

    <div class="mode-box">
      <button type="button" id="btnModeAdmin" class="mode-btn">Admin</button>
      <button type="button" id="btnModeUser" class="mode-btn">Login</button>
    </div>
    <div class="mode-hint" id="modeHint"></div>

    {% if error %}
      <div class="alert">{{ error }}</div>
    {% endif %}

    <form method="post" action="/login" id="loginForm">
      <input type="hidden" name="next" id="nextField" value="{{ next or '/' }}" />

      <label>Usuário</label>
      <input name="username" autocomplete="username" required />

      <label>Senha</label>
      <input name="password" type="password" autocomplete="current-password" required />

      <button class="btn" type="submit">Entrar</button>
    </form>

    <div class="links">
      <a href="/forgot">Esqueci minha senha</a>
    </div>
  </div>

  <script>
    const nextField = document.getElementById("nextField");
    const btnAdmin = document.getElementById("btnModeAdmin");
    const btnUser = document.getElementById("btnModeUser");
    const hint = document.getElementById("modeHint");

    function setMode(mode) {
      if (mode === "admin") {
        nextField.value = "/admin";
        btnAdmin.classList.add("active");
        btnUser.classList.remove("active");
        hint.textContent = "Admin: após autenticar, você será direcionado para o painel /admin (se tiver permissão).";
      } else {
        nextField.value = "/";
        btnUser.classList.add("active");
        btnAdmin.classList.remove("active");
        hint.textContent = "Login: acesso normal ao sistema de faturas.";
      }
    }

    const initialNext = (nextField.value || "/").trim();
    if (initialNext === "/admin") setMode("admin");
    else setMode("user");

    btnAdmin.addEventListener("click", () => setMode("admin"));
    btnUser.addEventListener("click", () => setMode("user"));
  </script>
</body>
</html>
